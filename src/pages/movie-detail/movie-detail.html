<ion-header>
  <ion-navbar>
    <ion-title *ngIf="currentMovie$ | async as movie">{{movie.title}}</ion-title>
  </ion-navbar>
</ion-header>

<ion-content class="movie-detail-main">

  <div class="backdrop" *ngIf="currentMovie$ | async as movie">
    <img *ngIf="movie.backdrop_path" [src]="'https://image.tmdb.org/t/p/w780' + movie.backdrop_path">
  </div>


  <div class="movieheader">

    <div class="movieheader__poster" *ngIf="currentMovie$ | async as movie; else presentLoading()">
      <img *ngIf="movie.poster_path" class="poster" [src]="'https://image.tmdb.org/t/p/w500' + movie.poster_path">
    </div>

    <div class="movieheader__details" *ngIf="currentMovie$ | async as movie;">
      <h1 class="movieheader__title">{{movie.title}}</h1>
      <div>{{movie.movieDescription}}</div>
      <div>
        <span class="text-grey">Runtime: </span> {{getMinToHours(movie.runtime)}}
      </div>
      <div>
        <span class="text-grey">Director:</span> John Doe
      </div>
      <div>
        <span class="text-grey">Writer:</span> John Doe
      </div>
    </div>
  </div>


  <div class="movieheader__btngroup" *ngIf="currentMovie$ | async as movie;">

    <button ion-button small round solid color="secondary" *ngIf="!movieInWatchList$ || !isAuthenticated()" class="movieheader__btn"
      (click)="toggleWatchlistItem(movie.id, true)"> Add to Watchlist
    </button>

    <button ion-button small round outline color="secondary" *ngIf="movieInWatchList$" class="movieheader__btn" (click)="toggleWatchlistItem(movie.id, false)">Remove
      from Watchlist
    </button>

    <button ion-button small round solid color="secondary" *ngIf="!movieInFavouritesList$  || !isAuthenticated()" class="movieheader__btn"
      (click)="toggleFavouritesItem(movie.id, true)">Add to Favourites
    </button>

    <button ion-button small round outline color="secondary" *ngIf="movieInFavouritesList$" class="movieheader__btn" (click)="toggleFavouritesItem(movie.id, false)">Remove
      from Favourites
    </button>
  </div>

  <!-- <div class="movienav-wrap">
    <ul class="movienav">
      <li class="movienav__item movienav__item--active">
        <a href="#">Info</a>
      </li>
      <li class="movienav__item">
        <a href="#">Trailer</a>
      </li>
      <li class="movienav__item">
        <a href="#">Comments</a>
      </li>
      <li class="movienav__item">
        <a href="#">Awards</a>
      </li>
      <li class="movienav__item">
        <a href="#">Reviews</a>
      </li>
    </ul>
  </div> -->

  <div class="moviePlot" *ngIf="currentMovie$ | async as movie;">
    <h4>Overview</h4>
    <p>{{movie.overview}}</p>
  </div>

  <div class="cast__slideshow" *ngIf="currentMovieCast$ | async as movieCast;">
    <h4>Cast</h4>
    <ion-slides slidesPerView="2.5">

      <div *ngFor="let castItem of movieCast.cast; let i = index">
        <div *ngIf="castItem.profile_path">
          <ion-slide *ngIf="i < 10">
            <img [src]="'https://image.tmdb.org/t/p/w200' + castItem.profile_path">
          </ion-slide>
        </div>
      </div>
    </ion-slides>
  </div>

  <div class="reviews-wrapper">
    <h4>Recent User Reviews</h4>
    <button ion-button (click)="displayReviewModal()" class="reviews-btn">Submit Review</button>

    <div *ngIf="!currentMovieReviews || currentMovieReviews.length == 0">
      <p>No Recent User Reviews</p>
    </div>

    <div *ngIf="currentMovieReviews && currentMovieReviews.length > 0">
      <div *ngFor="let review of currentMovieReviews">
        <p>{{review.reviewText}}</p>
        <div class="review">
          <div class="review__header">
            <img src="" alt="" class="review__avatar">
            <div class="review__userinfo">
              <span class="review__name">John Doe</span>
              <div class="span review__date">Feb 14, 1994</div>
            </div>
            <div class="review__rating">A+</div>
          </div>
          <div class="review__body">Lorem ipsum dolor sit amet consectetur adipisicing elit. Error inventore labore pariatur.</div>
        </div>
      </div>
    </div>

  </div>

</ion-content>